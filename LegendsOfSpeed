-- Legends Of Speed - Saul Hub версия
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/SaulGoodmanScripter/SAUL_HUB/refs/heads/main/Library%20.lua"))()
local Window = Library:Window({
    Title = "Legends Of Speed",
    Desc = "Legends Of Speed",
    Icon = 92155476988079,
    Theme = "NewYear",
    Config = {
        Keybind = Enum.KeyCode.LeftControl,
        Size = UDim2.new(0, 550, 0, 350)
    },
    CloseUIButton = {
        Enabled = true,
        Text = "Close/open"
    }
})

-- Функции уведомлений
local function Notify(title, desc, time)
    Window:Notify({
        Title = title,
        Desc = desc,
        Time = time or 3
    })
end

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")

-- Вкладки
local main = Window:Tab({Title = "Main", Icon = "home"})
local ss = Window:Tab({Title = "Auto Farm", Icon = "tractor"})
local sss = Window:Tab({Title = "Teleport", Icon = "map-pin"})
local race = Window:Tab({Title = "Race", Icon = "flag"})
local egg = Window:Tab({Title = "Crystal", Icon = "gem"})
local misc = Window:Tab({Title = "Misc", Icon = "settings"})
local how = Window:Tab({Title = "Glitch Help", Icon = "help-circle"})

-- Anti AFK
local antiAFK = true
LocalPlayer.Idled:Connect(function()
    if antiAFK then
        pcall(function()
            game:GetService("VirtualUser"):Button2Down(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
            wait(1)
            game:GetService("VirtualUser"):Button2Up(Vector2.new(0, 0), workspace.CurrentCamera.CFrame)
        end)
    end
end)

-- Разделы
main:Section({Title = "Main"})

-- Time Label
local timeLabelText = "[GameTime] : Loading..."
local timeLabel = main:Label({
    Title = "Game Time",
    Desc = timeLabelText
})

spawn(function()
    while task.wait() do
        pcall(function()
            local GameTime = math.floor(workspace.DistributedGameTime+0.5)
            local Hour = math.floor(GameTime/(60^2))%24
            local Minute = math.floor(GameTime/(60^1))%60
            local Second = math.floor(GameTime/(60^0))%60
            timeLabelText = "Hours: "..Hour.." Minutes: "..Minute.." Seconds: "..Second
            timeLabel:SetDesc(timeLabelText)
        end)
    end
end)

-- FPS Label
local fpsLabelText = "[Fps] : Loading..."
local fpsLabel = main:Label({
    Title = "FPS",
    Desc = fpsLabelText
})

spawn(function()
    while true do
        wait(.1)
        pcall(function()
            local Fps = math.floor(workspace:GetRealPhysicsFPS())
            fpsLabelText = "FPS: "..Fps
            fpsLabel:SetDesc(fpsLabelText)
        end)
    end
end)

-- Ping Label
local pingLabelText = "[Ping] : Loading..."
local pingLabel = main:Label({
    Title = "Ping",
    Desc = pingLabelText
})

spawn(function()
    while true do
        wait(.1)
        pcall(function()
            local Ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValueString()
            pingLabelText = "Ping: "..Ping
            pingLabel:SetDesc(pingLabelText)
        end)
    end
end)

-- Сохраняем позиции сундуков
local oldGoldenChestPosition
local oldEnchantedChestPosition
local oldMagmaChestPosition
local oldGroupRewardsPosition

pcall(function()
    oldGoldenChestPosition = workspace.goldenChest.circleInner.CFrame
    oldEnchantedChestPosition = workspace.enchantedChest.circleInner.CFrame
    oldMagmaChestPosition = workspace.magmaChest.circleInner.CFrame
    oldGroupRewardsPosition = workspace.groupRewardsCircle.circleInner.CFrame
end)

-- Claim All Chests
main:Button({
    Title = "Claim All Chests",
    Desc = "Забрать все сундуки",
    Callback = function()
        pcall(function()
            if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                Notify("Error", "Character not found!", 3)
                return
            end
            
            local hrp = LocalPlayer.Character.HumanoidRootPart
            
            if not oldGoldenChestPosition then
                oldGoldenChestPosition = workspace.goldenChest.circleInner.CFrame
            end
            if not oldEnchantedChestPosition then
                oldEnchantedChestPosition = workspace.enchantedChest.circleInner.CFrame
            end
            if not oldMagmaChestPosition then
                oldMagmaChestPosition = workspace.magmaChest.circleInner.CFrame
            end
            if not oldGroupRewardsPosition then
                oldGroupRewardsPosition = workspace.groupRewardsCircle.circleInner.CFrame
            end
            
            workspace.goldenChest.circleInner.CFrame = hrp.CFrame
            workspace.enchantedChest.circleInner.CFrame = hrp.CFrame
            workspace.magmaChest.circleInner.CFrame = hrp.CFrame
            workspace.groupRewardsCircle.circleInner.CFrame = hrp.CFrame
            wait(0.5)
            workspace.goldenChest.circleInner.CFrame = oldGoldenChestPosition
            workspace.enchantedChest.circleInner.CFrame = oldEnchantedChestPosition
            workspace.magmaChest.circleInner.CFrame = oldMagmaChestPosition
            workspace.groupRewardsCircle.circleInner.CFrame = oldGroupRewardsPosition
            
            Notify("Success", "All chests claimed!", 2)
        end)
    end
})

-- Auto Rebirth
main:Toggle({
    Title = "Auto Rebirth",
    Desc = "Авто-реборн",
    Value = false,
    Callback = function(state)
        _G.Rebirth = state
        while _G.Rebirth do
            wait()
            pcall(function()
                ReplicatedStorage.rEvents.rebirthEvent:FireServer("rebirthRequest")
            end)
        end
    end
})

-- NoClip
RunService.Stepped:Connect(function()
    if _G.NoClip then
        pcall(function()
            for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") then
                    v.CanCollide = false
                end
            end
        end)
    end
end)

main:Toggle({
    Title = "No Clip",
    Desc = "Ходить сквозь стены",
    Value = false,
    Callback = function(value)
        _G.NoClip = value
    end
})

main:Button({
    Title = "Disable Trading",
    Desc = "Отключить торговлю",
    Callback = function()
        pcall(function()
            ReplicatedStorage.rEvents.tradingEvent:FireServer("disableTrading")
            Notify("Success", "Trading disabled", 2)
        end)
    end
})

main:Button({
    Title = "Enable Trading",
    Desc = "Включить торговлю",
    Callback = function()
        pcall(function()
            ReplicatedStorage.rEvents.tradingEvent:FireServer("enableTrading")
            Notify("Success", "Trading enabled", 2)
        end)
    end
})

-- Функция для списка игроков
local function GetPlayerListWithDisplay()
    local list = {}
    local mapping = {}
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer then
            local displayText = v.DisplayName .. " (@" .. v.Name .. ")"
            table.insert(list, displayText)
            mapping[displayText] = v.Name
        end
    end
    return list, mapping
end

local PlayerList, PlayerMapping = GetPlayerListWithDisplay()
local TpPlayer = nil

local PlayerDropdown = main:Dropdown({
    Title = "Select Player",
    Desc = "Выберите игрока для телепорта",
    Options = PlayerList,
    Value = PlayerList[1] or "",
    Callback = function(value)
        TpPlayer = PlayerMapping[value]
    end
})

-- Обновление списка игроков
Players.PlayerAdded:Connect(function(plr)
    task.wait(0.5)
    PlayerList, PlayerMapping = GetPlayerListWithDisplay()
    pcall(function()
        PlayerDropdown:Refresh(PlayerList, PlayerList[1] or "")
    end)
end)

Players.PlayerRemoving:Connect(function(plr)
    task.wait(0.5)
    PlayerList, PlayerMapping = GetPlayerListWithDisplay()
    if TpPlayer == plr.Name then
        TpPlayer = nil
    end
    pcall(function()
        PlayerDropdown:Refresh(PlayerList, PlayerList[1] or "")
    end)
end)

main:Button({
    Title = "Refresh Player List",
    Desc = "Обновить список игроков",
    Callback = function()
        PlayerList, PlayerMapping = GetPlayerListWithDisplay()
        pcall(function()
            PlayerDropdown:Refresh(PlayerList, PlayerList[1] or "")
        end)
        Notify("Success", "Player list refreshed!", 2)
    end
})

main:Button({
    Title = "Teleport To Player",
    Desc = "Телепорт к игроку",
    Callback = function()
        if not TpPlayer then
            Notify("Error", "Please select a player first!", 3)
            return
        end
        
        local targetPlayer = Players:FindFirstChild(TpPlayer)
        if not targetPlayer then
            Notify("Error", "Player not found! They may have left.", 3)
            return
        end
        
        if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            Notify("Error", "Target player's character not found!", 3)
            return
        end
        
        if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            Notify("Error", "Your character not found!", 3)
            return
        end
        
        local success, err = pcall(function()
            LocalPlayer.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 2, 1)
        end)
        
        if success then
            Notify("Success", "Teleported to " .. targetPlayer.DisplayName, 2)
        else
            Notify("Error", "Teleport failed: " .. tostring(err), 3)
        end
    end
})

main:Slider({
    Title = "Speed",
    Desc = "Скорость передвижения",
    Min = 0,
    Max = 5000,
    Value = 300,
    Callback = function(v)
        pcall(function()
            LocalPlayer.Character.Humanoid.WalkSpeed = v
        end)
    end
})

main:Slider({
    Title = "Jump",
    Desc = "Сила прыжка",
    Min = 0,
    Max = 1000,
    Value = 50,
    Callback = function(v)
        pcall(function()
            LocalPlayer.Character.Humanoid.JumpPower = v
        end)
    end
})

-- Auto Farm Tab
ss:Section({Title = "Auto Farm"})
ss:Label({
    Title = "Farm Setting",
    Desc = "Настройки фарма"
})

local locate = "City"
ss:Dropdown({
    Title = "Select Location",
    Desc = "Выберите локацию",
    Options = {"City", "Snow City", "Magma City", "Legends Highway", "Space", "Desert"},
    Value = "City",
    Callback = function(value)
        locate = value
    end
})

local orbs = "Red Orb"
ss:Dropdown({
    Title = "Select Orbs",
    Desc = "Выберите орбы",
    Options = {"Red Orb", "Yellow Orb", "Gem"},
    Value = "Red Orb",
    Callback = function(value)
        orbs = value
    end
})

local setFarm = 20
ss:Dropdown({
    Title = "Select Mode",
    Desc = "Выберите режим",
    Options = {"Super Fast", "Fast", "Medium", "Slow"},
    Value = "Medium",
    Callback = function(value)
        if value == "Super Fast" then
            setFarm = 40
        elseif value == "Fast" then
            setFarm = 30
        elseif value == "Medium" then
            setFarm = 20
        elseif value == "Slow" then
            setFarm = 10
        end
    end
})

ss:Label({
    Title = "Speed Values",
    Desc = "Super Fast = 40\nFast = 30\nMedium = 20\nSlow = 10"
})

ss:Toggle({
    Title = "Start Farm",
    Desc = "Начать фарм орбов",
    Value = false,
    Callback = function(state)
        _G.Farm = state
        while _G.Farm do
            wait()
            pcall(function()
                for i = 1, setFarm do
                    ReplicatedStorage.rEvents.orbEvent:FireServer("collectOrb", orbs, locate)
                end
            end)
        end
    end
})

ss:Toggle({
    Title = "Hoops Farm",
    Desc = "Фарм обручей",
    Value = false,
    Callback = function(state)
        _G.Hoops = state
        while _G.Hoops do
            wait()
            pcall(function()
                for _, child in ipairs(workspace.Hoops:GetChildren()) do
                    if child.Name == 'Hoop' then
                        child.Transparency = 1
                        child.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame
                    end
                end
            end)
        end
    end
})

-- Race Tab
race:Section({Title = "Race"})

ReplicatedStorage.raceInProgress.Changed:Connect(function(state)
    if not getgenv().AutoRace then return end
    if state then
        pcall(function()
            ReplicatedStorage.rEvents.raceEvent:FireServer('joinRace')
            wait()
            LocalPlayer.PlayerGui.gameGui.raceJoinLabel.Visible = false
        end)
    end
end)

ReplicatedStorage.raceStarted.Changed:Connect(function(state)
    if not getgenv().AutoRace then return end
    if state then
        pcall(function()
            for _, v in pairs(workspace.raceMaps:GetChildren()) do
                local oldFinishPosition = v.finishPart.CFrame
                v.finishPart.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame
                wait()
                v.finishPart.CFrame = oldFinishPosition
            end
        end)
    end
end)

race:Toggle({
    Title = "Auto Finish Race",
    Desc = "Автоматически завершать гонки",
    Value = false,
    Callback = function(state)
        getgenv().AutoRace = state
    end
})

-- Teleport Tab
sss:Section({Title = "Teleports"})

if game.PlaceId == 3101667897 then
    sss:Button({
        Title = "City",
        Desc = "Телепорт в City",
        Callback = function()
            pcall(function()
                LocalPlayer.Character:MoveTo(Vector3.new(-9687.1923828125, 59.072853088378906, 3096.58837890625))
                Notify("Success", "Teleported to City", 2)
            end)
        end
    })
    
    sss:Button({
        Title = "Snow City",
        Desc = "Телепорт в Snow City",
        Callback = function()
            pcall(function()
                LocalPlayer.Character:MoveTo(Vector3.new(-9677.6640625, 59.072853088378906, 3783.736572265625))
                Notify("Success", "Teleported to Snow City", 2)
            end)
        end
    })
    
    sss:Button({
        Title = "Magma City",
        Desc = "Телепорт в Magma City",
        Callback = function()
            pcall(function()
                LocalPlayer.Character:MoveTo(Vector3.new(-11053.3837890625, 217.0328369140625, 4896.10986328125))
                Notify("Success", "Teleported to Magma City", 2)
            end)
        end
    })
    
    sss:Button({
        Title = "Legends Highway",
        Desc = "Телепорт в Legends Highway",
        Callback = function()
            pcall(function()
                LocalPlayer.Character:MoveTo(Vector3.new(-13097.8583984375, 217.0328369140625, 5904.84716796875))
                Notify("Success", "Teleported to Legends Highway", 2)
            end)
        end
    })
    
    sss:Button({
        Title = "Space",
        Desc = "Телепорт в Space",
        Callback = function()
            TeleportService:Teleport(3232996272, LocalPlayer)
        end
    })
    
    sss:Button({
        Title = "Desert",
        Desc = "Телепорт в Desert",
        Callback = function()
            TeleportService:Teleport(3276265788, LocalPlayer)
        end
    })
elseif game.PlaceId == 3232996272 then
    sss:Button({
        Title = "City",
        Desc = "Телепорт в City",
        Callback = function()
            TeleportService:Teleport(3101667897, LocalPlayer)
        end
    })
    
    sss:Button({
        Title = "Desert",
        Desc = "Телепорт в Desert",
        Callback = function()
            TeleportService:Teleport(3276265788, LocalPlayer)
        end
    })
elseif game.PlaceId == 3276265788 then
    sss:Button({
        Title = "City",
        Desc = "Телепорт в City",
        Callback = function()
            TeleportService:Teleport(3101667897, LocalPlayer)
        end
    })
    
    sss:Button({
        Title = "Space",
        Desc = "Телепорт в Space",
        Callback = function()
            TeleportService:Teleport(3232996272, LocalPlayer)
        end
    })
end

-- Crystal Tab
egg:Section({Title = "Crystal"})

local Crystal = {}
pcall(function()
    for _, v in pairs(workspace.mapCrystalsFolder:GetChildren()) do
        table.insert(Crystal, v.Name)
    end
end)

local function OpenCrystal(v)
    pcall(function()
        ReplicatedStorage.rEvents.openCrystalRemote:InvokeServer("openCrystal", v)
    end)
end

local OPENEGG = Crystal[1] or ""

egg:Dropdown({
    Title = "Select Crystal",
    Desc = "Выберите кристалл",
    Options = Crystal,
    Value = Crystal[1] or "",
    Callback = function(value)
        OPENEGG = value
    end
})

egg:Toggle({
    Title = "Open Crystal",
    Desc = "Авто-открытие кристаллов",
    Value = false,
    Callback = function(state)
        _G.Mm = state
        while _G.Mm do
            wait()
            if OPENEGG and OPENEGG ~= "" then
                OpenCrystal(OPENEGG)
            end
        end
    end
})

-- Auto sell loops
spawn(function()
    while wait() do
        if _G.AutoSellAllTrails then
            pcall(function()
                for _, rankFolder in pairs(LocalPlayer.trailsFolder:GetChildren()) do
                    local rankName = rankFolder.Name
                    for _, item in pairs(LocalPlayer.trailsFolder[rankName]:GetChildren()) do
                        ReplicatedStorage.rEvents.sellTrailEvent:FireServer("sellTrail", item)
                    end
                end
            end)
        end
    end
end)

spawn(function()
    while wait() do
        if _G.AutoSellAllPets then
            pcall(function()
                for _, rankFolder in pairs(LocalPlayer.petsFolder:GetChildren()) do
                    local rankName = rankFolder.Name
                    for _, item in pairs(LocalPlayer.petsFolder[rankName]:GetChildren()) do
                        if item.Name ~= "Ultra Birdie" then
                            ReplicatedStorage.rEvents.sellPetEvent:FireServer("sellPet", item)
                        end
                    end
                end
            end)
        end
    end
end)

spawn(function()
    while wait() do
        if _G.BunnyFarm then
            pcall(function()
                for _, rankFolder in pairs(LocalPlayer.petsFolder:GetChildren()) do
                    local rankName = rankFolder.Name
                    for _, item in pairs(LocalPlayer.petsFolder[rankName]:GetChildren()) do
                        if item.Name ~= "Ultimate Overdrive Bunny" then
                            ReplicatedStorage.rEvents.sellPetEvent:FireServer("sellPet", item)
                        end
                    end
                end
            end)
        end
    end
end)

spawn(function()
    while wait() do
        if _G.AutoUnique then
            pcall(function()
                for _, rankFolder in pairs(LocalPlayer.petsFolder:GetChildren()) do
                    local rankName = rankFolder.Name
                    if rankName ~= "Unique" then
                        for _, item in pairs(LocalPlayer.petsFolder[rankName]:GetChildren()) do
                            ReplicatedStorage.rEvents.sellPetEvent:FireServer("sellPet", item)
                        end
                    end
                end
            end)
        end
    end
end)

spawn(function()
    while wait() do
        if _G.OpenBirdieEgg then
            OpenCrystal("Electro Crystal")
        end
    end
end)

spawn(function()
    while wait() do
        if _G.OpenVoidEgg then
            OpenCrystal("Desert Crystal")
        end
    end
end)

spawn(function()
    while wait() do
        if _G.OpenLegendsEgg then
            OpenCrystal("Electro Legends Crystal")
        end
    end
end)

egg:Toggle({
    Title = "Auto Void Dragon [Desert]",
    Desc = "Авто-фарм Void Dragon",
    Value = false,
    Callback = function(state)
        _G.OpenVoidEgg = state
        _G.AutoUnique = state
        _G.AutoSellAllTrails = state
    end
})

egg:Toggle({
    Title = "Auto Ultra Birdie [Best Pet Desert]",
    Desc = "Авто-фарм Ultra Birdie",
    Value = false,
    Callback = function(state)
        _G.OpenBirdieEgg = state
        _G.AutoSellAllPets = state
        _G.AutoSellAllTrails = state
    end
})

egg:Toggle({
    Title = "Auto Ultimate Overdrive Bunny",
    Desc = "Авто-фарм Overdrive Bunny",
    Value = false,
    Callback = function(state)
        _G.BunnyFarm = state
        _G.OpenLegendsEgg = state
    end
})

egg:Toggle({
    Title = "Auto Evolved All Pets",
    Desc = "Авто-эволюция всех питомцев",
    Value = false,
    Callback = function(state)
        _G.Evo = state
        while _G.Evo do
            wait()
            pcall(function()
                for _, rankFolder in pairs(LocalPlayer.petsFolder:GetChildren()) do
                    for _, pet in pairs(rankFolder:GetChildren()) do
                        ReplicatedStorage.rEvents.petEvolveEvent:FireServer("evolvePet", pet.Name)
                    end
                end
            end)
        end
    end
})

-- Misc Tab
misc:Section({Title = "Misc"})

misc:Toggle({
    Title = "Hide Popups",
    Desc = "Скрыть попапы",
    Value = false,
    Callback = function(state)
        getgenv().HidePopups = state
        pcall(function()
            if not getgenv().HidePopups then
                LocalPlayer.PlayerGui.orbGui.Enabled = true
                LocalPlayer.PlayerGui.gameGui.trailsNotificationsFrame.Visible = true
                return
            end
            LocalPlayer.PlayerGui.orbGui.Enabled = false
            LocalPlayer.PlayerGui.gameGui.trailsNotificationsFrame.Visible = false
        end)
    end
})

-- Infinite Jump
local InfiniteJumpEnabled = false
misc:Toggle({
    Title = "Inf Jump",
    Desc = "Бесконечные прыжки",
    Value = false,
    Callback = function(v)
        InfiniteJumpEnabled = v
    end
})

UserInputService.JumpRequest:Connect(function()
    if InfiniteJumpEnabled then
        pcall(function()
            LocalPlayer.Character:FindFirstChildOfClass('Humanoid'):ChangeState("Jumping")
        end)
    end
end)

misc:Button({
    Title = "Rejoin",
    Desc = "Перезайти в игру",
    Callback = function()
        TeleportService:Teleport(game.PlaceId, LocalPlayer)
    end
})

misc:Button({
    Title = "Low Server Hop",
    Desc = "Переход на сервер с малым пингом",
    Callback = function()
        pcall(function()
            local module = loadstring(game:HttpGet"https://raw.githubusercontent.com/raw-scriptpastebin/FE/main/Server_Hop_Settings")()
            module:Teleport(game.PlaceId)
        end)
    end
})

-- Glitch Help Tab
how:Section({Title = "Tutorial"})
how:Label({
    Title = "How to use the glitch:",
    Desc = "1. Use Pet Level 1 No XP\n2. Turn on Yellow Orbs In Auto Farm Menu\n3. Don't Get About XP\n4. Don't Use Other Features Except Yellow Orbs\n5. Done"
})

how:Section({Title = "Notes"})
how:Label({
    Title = "Important Notes:",
    Desc = "> Make sure your Rebirth is Odd\n> The Power Pet Will Return If You Disconnect"
})

Notify("Legends Of Speed", "Script loaded successfully!", 5)
print("Legends Of Speed - Saul Hub version loaded!")
               